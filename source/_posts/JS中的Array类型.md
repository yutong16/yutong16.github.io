---
title: JS中的Array类型
author: yutong16
date: 2016-1-18 10:03:02
categories: 个人博客
tags: JavaScript
---
　　除了Object之外，在ECMAScript中最常用的就是Array类型。这种Array类型相比其他语言不同的是，数组中的每一项都可以保存任何类型的数据，比如第一项保存数值，第二项保存字符串，第三项保存对象等等。而且数组的长度大小是可以动态调整的，随着数据项的增加自动增长。  
　　创建数组的基本方式有两种，一是使用Array构造函数，如下：`var test = new Array();`其中Array可以传递数据项的值，也可以传递数组长度。  
　　二是使用数组字面量的方式，这是推荐创建数组的方式，从js性能优化的角度上来将，对象字面量创建数组不用调用Array的构造函数，降低内存消耗。数组字面量由一对包含数组项的方括号表示，多个数组项之间用逗号隔开，如下：`var test = [1,2];`。如果这样创建数组`var test = [, , ,]`则字面量会根据逗号创建3个或者4个数据项的数组，不建议这样做。  
1.**检测数组**  
　　`value instanceof Array`可以判断value是否是Array类型。但是instanceof操作符的问题在于，它假定只有一个全局执行环境。如果网页中包含多个框架，那实际上就存在两个以上不同的全局执行环境，从而存在两个以上不同版本的Array构造函数。如果你从一个框架向另一个框架传入一个数组，那么传入的数组与第二个框架中原生创建的数组就分别具有不用的构造函数。为了解决这个问题，ECMAScript5增加了`Array.isArray()`方法。这个方法的目的是最终确定某个值到底是不是数组，而不管它是在那个全局执行环境中创建的。  
2.**转换方法**  
　　所有对象都具有toLocaleString(),toString(),valueOf()方法。其中，调用数组的toString()方法会返回数组中每个值的字符串形式拼接而成的一个以逗号分隔的字符串。而调用valueOf()返回的还是数组。  
　　另外，toLocaleString()方法也经常返回与toString()和valueOf()方法相同的值，但也不总如此。当调用数组的toLocaleString()时，它也会创建一个数组值的以逗号分隔的字符串，而与前两者唯一不同之处在于，这里调用的是每一项的toLocaleString()方法，而不是toString()方法。如下例子：  
```
    var person1 = {
        toLocaleString:function(){
            return 'Locale';
        },
        toString: function(){
            return 'string';
        }
    };
    var person2 = {
        toLocaleString: function(){
            return 'Locale2';
        },
        toString: function(){
            return 'string2'
        }
    };
    var people = [person1, person2];
    alert(people);              //string,string2
    alert(people.toString())    //string,string2
    alert(people.toLocaleString())      //Locale,Locale2
```
上面通过重写两个对象的toString()和toLocaleString()方法， 可以看出调用不同的方法，返回值不同。  
　　数组继承的toLocaleString(),toString(),valueOf()方法，在默认情况下都会以逗号分隔字符串形式返回数组想。而如果使用join()方法，则可以使用不同的分隔符来构建这个字符串。join方法只接受一个参数，即用做分隔符的字符串，然后返回包含所有数组项的字符串。*如果不给join()传入任何值，或者传入undefined，则使用默认逗号分隔符。IE7及以前的版本会错误的使用undefined作为分隔符*。  
***如果数组中的某一项的值是null或者undefined，那么该值在join(),toLocaleString(),toString()和valueOf()方法返回的结果中以空字符串表示。***  
3.**数组的堆栈**  
　　栈是一种LIFO(last-in-first-out)后进先出的数据结构。栈中数据的操作只发生在一个位置----栈的顶部。push()方法可以接受任意数量的参数，将其逐个添加到数组的末尾，并返回修改后数组的长度。pop()方法则从数组末尾移除最后一向，减少数组的length值，然后返回移除的项。  
　　队列数据结构的规则是FIFO(first-in-first-out)先进先出。队列的数据项在末尾添加，在首部移除。push()从尾部添加，所以shift()则是从头部删除，返回被删除的项，数组长度减1。unshift()则是在数组头部添加任意项，并返回新数组的长度。***IE7及以前的版本中，unshift()方法总是返回undefined而不是数组的新长度。IE8兼容模式下会返回正确的值***  
4.**排序方法**  
　　reverse()方法反转数组项的顺序。  
　　默认情况下sort()方法是以升序的方式进行排序。sort()方法会调用每个数组项的toString()方法，然后比较得到字符串进行排序。这种默认排序方式存在很大的问题，所以sort()可以接受一个比较函数作为参数，以便我们指定哪个值位于哪个值的前面。  
　　比较函数接收两个参数，如果第一个参数应该位于第二个之前则返回一个负数，如果两个参数相等则返回0，如果第一个参数应该位于第二个之后则返回正数。如下：
```
function compare(val1, val2){
    if(val1 < val2){
        return -1;
    }else if(val1 > val2){
        return 1;
    }else {
        return 0;
    }
}
```
这个比较函数可以适用大多数数据类型，只要将其作为参数传递给sort()方法即可。如下：
```
var values=[0,15,3,56,4];
values.sort(compare);
alert(value);       //0,3,4,15,56
```
也可以通过比较函数产生降序的结果，只需要交换比较函数返回的值即可。  
***reserve()和sort()方法的返回值是经过排序之后的数组。***
5.**操作方法**
　　concat()方法，可以将接受到的参数添加到这个副本的末尾，最后返回新构建的数组。该方法会先创建一个当前数组的一个副本。如果concat()没有参数，则返回一个当前数组的副本。  
　　slice()方法，基于当前数组中的一或多个项创建一个新数组。接收一或两个参数，即要返回项的起始或结束位置。只有一个参数的情况下，则返回从起始到当前数组末尾的所有项。如果两个参数，则返回从起始开始到结束位置之间的项，但不包括结束位置的项。slice()不会影响原来数组。  
　　splice()方法，主要用途是向数组中插入项：  
> **删除**：可以删除任意数量的项，只需指定2个参数：要删除的第一项的位置和要删除的项数，例如splice(0,2)会删除数组中的前两项；  
> **插入**：可以向指定位置插入任意数量的项，提供3个参数：起始位置，0（要删除的项），要插入的项；  
> **替换**：可以向指定位置插入任意数量的项，且同时删除任意数量的项，提供3个参数：起始位置，要删除的项数和要插入的任意数量的项。  
　　splice()方法始终返回一个数组，该数组中包含从原始数组中删除的项（若没有删除任何项，则返回一个空数组）。  

6.**位置方法**  
　　indexOf()和lastIndexOf(),都接受两个参数：要查找的项和（可选）查找起点位置的索引。indexOf()从前往后查找，lastIndexOf()从后往前查找。  
7.**迭代方法**  
　　ECMAScript5为数组定义了5个迭代方法。每个方法都接收两个参数：要在每一项上运行的函数和（可选）运行该函数的作用域对象---影响this的值。传入这些方法中的函数会接收三个参数：数组项的值，该项在数组中的位置和数组对象本身。
> **every()**: 对数组中的每一项运行给定函数，如果该函数的每一项都返回true，则返回true;  
> **filter()**: 对数组中的每一项运行给定函数，返回该函数会返回true的项组成的数组;  
> **forEach()**: 对数组中的每一项运行给定的函数。这个方法没有返回值;  
> **map()**: 对数组中的每一项运行给定函数，返回每次函数调用的结果组成的数组;  
> **some()**: 对数组中的每一项运行给定函数，如果该函数对任一项返回true,则返回true。  

****以上方法都不会修改数组中的包含的值****  
8.**归并方法**  
　　reduce()和reduceRight()。都会迭代数组的所有项，然后构建一个最终返回的值。其中reduce()方法从数组的第一项开始，逐个遍历到最后。而reduceRight()则从数组的最后一项开始，遍历到第一项。  
　　这两个方法都接收两个参数：一个在每一项上调用的函数和（可选）作为归并基础的初始值。传给reduce()和reduceRight()的函数接收4个参数：前一个值，当前值，项的索引和数组对象。***这个函数返回的任何值都会作为第一个参数自动传给下一项。第一次迭代发生在数组的第二项上，因此第一个参数是数组的第一项，第二个参数就是数组的第二项。如下，利用reduce()方法归并求和：
```
var value = [1,2,3,4,5];
var sum = value.reduce(function(pre, cur, index, array){
    return prev + cur;
});
alert(sum);             //15
```
　　以上是JS数组拥有的基本信息，部分摘抄自《JavaScript高级程序设计3》，供以后复习。

